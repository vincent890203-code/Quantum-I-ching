<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>architecture_diagram</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="ARCHITECTURE_DIAGRAM_files/libs/clipboard/clipboard.min.js"></script>
<script src="ARCHITECTURE_DIAGRAM_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="ARCHITECTURE_DIAGRAM_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="ARCHITECTURE_DIAGRAM_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="ARCHITECTURE_DIAGRAM_files/libs/quarto-html/popper.min.js"></script>
<script src="ARCHITECTURE_DIAGRAM_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ARCHITECTURE_DIAGRAM_files/libs/quarto-html/anchor.min.js"></script>
<link href="ARCHITECTURE_DIAGRAM_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ARCHITECTURE_DIAGRAM_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ARCHITECTURE_DIAGRAM_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ARCHITECTURE_DIAGRAM_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ARCHITECTURE_DIAGRAM_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="quantum-i-ching-ç³»çµ±æ¶æ§‹åœ–" class="level1">
<h1>Quantum I-Ching ç³»çµ±æ¶æ§‹åœ–</h1>
<section id="å®Œæ•´ç³»çµ±æ¶æ§‹é¡ä¼¼-rag-æ¶æ§‹åœ–é¢¨æ ¼" class="level2">
<h2 class="anchored" data-anchor-id="å®Œæ•´ç³»çµ±æ¶æ§‹é¡ä¼¼-rag-æ¶æ§‹åœ–é¢¨æ ¼">å®Œæ•´ç³»çµ±æ¶æ§‹ï¼ˆé¡ä¼¼ RAG æ¶æ§‹åœ–é¢¨æ ¼ï¼‰</h2>
<pre class="mermaid"><code>flowchart TB
    subgraph DataLayer["ğŸ“Š è³‡æ–™ç²å–å±¤ (Data Acquisition Layer)"]
        direction TB
        Yahoo["Yahoo Finance API&lt;br/&gt;(å¤–éƒ¨è³‡æ–™ä¾†æº)"]
        Loader["MarketDataLoader&lt;br/&gt;(data_loader.py)&lt;br/&gt;â€¢ æ”¯æ´ TW/US/CRYPTO&lt;br/&gt;â€¢ è‡ªå‹•æ ¼å¼åŒ– ticker&lt;br/&gt;â€¢ ä¸‹è¼‰ OHLCV è³‡æ–™"]
        Config["Settings &amp; HEXAGRAM_MAP&lt;br/&gt;(config.py)&lt;br/&gt;â€¢ å…¨åŸŸè¨­å®š&lt;br/&gt;â€¢ 64å¦å°ç…§è¡¨"]
        
        Yahoo --&gt; Loader
        Config --&gt; Loader
    end

    subgraph EncodingLayer["ğŸ”¢ å¦è±¡ç·¨ç¢¼å±¤ (Hexagram Encoding Layer)"]
        direction TB
        Encoder["MarketEncoder&lt;br/&gt;(market_encoder.py)&lt;br/&gt;â€¢ è¨ˆç®—æŠ€è¡“æŒ‡æ¨™&lt;br/&gt;â€¢ RVOL ç™¾åˆ†ä½æ•¸&lt;br/&gt;â€¢ å¤§è¡ä¹‹æ•¸æ˜ å°„&lt;br/&gt;â€¢ å››è±¡(6/7/8/9) â†’ å…­çˆ»"]
        Core["IChingCore&lt;br/&gt;(iching_core.py)&lt;br/&gt;â€¢ æœ¬å¦è§£ç¢¼&lt;br/&gt;â€¢ ä¹‹å¦è¨ˆç®—&lt;br/&gt;â€¢ å‹•çˆ»è­˜åˆ¥"]
        HexMap["HEXAGRAM_MAP&lt;br/&gt;(64å¦å°ç…§è¡¨)"]
        
        Encoder --&gt; Core
        Core --&gt; HexMap
    end

    subgraph KnowledgeLayer["ğŸ“š çŸ¥è­˜æª¢ç´¢å±¤ (Knowledge Retrieval Layer)"]
        direction TB
        Setup["setup_iching_db.py&lt;br/&gt;â€¢ ä¸‹è¼‰æ˜“ç¶“è³‡æ–™&lt;br/&gt;â€¢ è½‰æ›çµ±ä¸€æ ¼å¼"]
        Convert["convert_iching_s2t.py&lt;br/&gt;â€¢ ç°¡é«”è½‰ç¹é«”"]
        JSON["iching_complete.json&lt;br/&gt;(64å¦å®Œæ•´è³‡æ–™)"]
        KLoader["IChingKnowledgeLoader&lt;br/&gt;(knowledge_loader.py)&lt;br/&gt;â€¢ JSON â†’ æ–‡ä»¶ç‰©ä»¶&lt;br/&gt;â€¢ ä¸»å¦ + å…­çˆ»&lt;br/&gt;â€¢ ç´„450ä»½æ–‡ä»¶"]
        VectorDB["IChingVectorStore&lt;br/&gt;(vector_store.py)&lt;br/&gt;â€¢ ChromaDB&lt;br/&gt;â€¢ SentenceTransformers&lt;br/&gt;â€¢ èªç¾©æœå°‹ + åš´æ ¼éæ¿¾"]
        
        Setup --&gt; JSON
        Convert --&gt; JSON
        JSON --&gt; KLoader
        KLoader --&gt; VectorDB
        Convert --&gt; VectorDB
    end

    subgraph AppLayer["ğŸ“± æ‡‰ç”¨å±¤ (Application Layer)"]
        direction TB
        Dashboard["Streamlit Dashboard&lt;br/&gt;(dashboard.py)&lt;br/&gt;â€¢ Kç·šåœ–è¦–è¦ºåŒ–&lt;br/&gt;â€¢ å¦è±¡å¡ç‰‡&lt;br/&gt;â€¢ é‡åŒ–æ©‹æ¥æŒ‡æ¨™&lt;br/&gt;â€¢ Oracle è§£è®€é¡¯ç¤º"]
        Oracle["Oracle é¡åˆ¥&lt;br/&gt;(oracle_chat.py)&lt;br/&gt;â€¢ ä¹‹å¦ç­–ç•¥è§£æ&lt;br/&gt;â€¢ è²/æ‚”æ¶æ§‹&lt;br/&gt;â€¢ æ˜“ç¶“æ–‡æœ¬æª¢ç´¢&lt;br/&gt;â€¢ Gemini API æ•´åˆ"]
        CLI["CLI å·¥å…·&lt;br/&gt;(main.py)&lt;br/&gt;â€¢ å‘½ä»¤åˆ—ä»‹é¢&lt;br/&gt;â€¢ ASCII è—è¡“å¦è±¡"]
        Gemini["Google Gemini API&lt;br/&gt;(å¤–éƒ¨ LLM)&lt;br/&gt;â€¢ gemini-2.5-flash&lt;br/&gt;â€¢ çµæ§‹åŒ–è¼¸å‡º"]
        
        Dashboard --&gt; Oracle
        CLI --&gt; Encoder
        Oracle --&gt; Gemini
    end

    subgraph MLLayer["ğŸ¤– æ©Ÿå™¨å­¸ç¿’å±¤ (ML Layer) - å¯é¸"]
        direction TB
        Processor["DataProcessor&lt;br/&gt;(data_processor.py)&lt;br/&gt;â€¢ æº–å‚™ LSTM è³‡æ–™&lt;br/&gt;â€¢ é›™æµ Embedding&lt;br/&gt;â€¢ æ•¸å€¼ç‰¹å¾µæ¨™æº–åŒ–"]
        LSTM["QuantumLSTM&lt;br/&gt;(model_lstm.py)&lt;br/&gt;â€¢ é›™æµ Embedding&lt;br/&gt;â€¢ 2å±¤ LSTM&lt;br/&gt;â€¢ äºŒåˆ†é¡è¼¸å‡º"]
        Backtest["QuantumBacktester&lt;br/&gt;(backtester.py)&lt;br/&gt;â€¢ ç­–ç•¥å›æ¸¬&lt;br/&gt;â€¢ ç¸¾æ•ˆè©•ä¼°"]
        
        Processor --&gt; LSTM
        LSTM --&gt; Backtest
    end

    %% è³‡æ–™æµç¨‹
    Loader --&gt; Encoder
    Encoder --&gt; Core
    Core --&gt; Dashboard
    Core --&gt; Oracle
    Core --&gt; Processor
    
    Oracle --&gt; VectorDB
    VectorDB --&gt; JSON
    
    Processor --&gt; LSTM

    %% æ¨£å¼
    classDef dataLayer fill:#e8f5e9,stroke:#2e7d32,stroke-width:3px,color:#000
    classDef encodingLayer fill:#fff3e0,stroke:#f57c00,stroke-width:3px,color:#000
    classDef knowledgeLayer fill:#f3e5f5,stroke:#7b1fa2,stroke-width:3px,color:#000
    classDef appLayer fill:#e1f5fe,stroke:#0277bd,stroke-width:3px,color:#000
    classDef mlLayer fill:#fce4ec,stroke:#c2185b,stroke-width:3px,color:#000
    classDef external fill:#fff9c4,stroke:#f9a825,stroke-width:3px,color:#000

    class Yahoo,Loader,Config dataLayer
    class Encoder,Core,HexMap encodingLayer
    class Setup,Convert,JSON,KLoader,VectorDB knowledgeLayer
    class Dashboard,Oracle,CLI appLayer
    class Processor,LSTM,Backtest mlLayer
    class Gemini external</code></pre>
<hr>
</section>
<section id="è©³ç´°è³‡æ–™æµç¨‹åœ–" class="level2">
<h2 class="anchored" data-anchor-id="è©³ç´°è³‡æ–™æµç¨‹åœ–">è©³ç´°è³‡æ–™æµç¨‹åœ–</h2>
<section id="ä¸»è¦æµç¨‹ä½¿ç”¨è€…æŸ¥è©¢-oracle-è§£è®€" class="level3">
<h3 class="anchored" data-anchor-id="ä¸»è¦æµç¨‹ä½¿ç”¨è€…æŸ¥è©¢-oracle-è§£è®€">ä¸»è¦æµç¨‹ï¼šä½¿ç”¨è€…æŸ¥è©¢ â†’ Oracle è§£è®€</h3>
<pre class="mermaid"><code>sequenceDiagram
    autonumber
    participant U as ğŸ‘¤ ä½¿ç”¨è€…
    participant D as ğŸ“± Dashboard
    participant DL as ğŸ“Š MarketDataLoader
    participant ME as ğŸ”¢ MarketEncoder
    participant IC as ğŸ”¢ IChingCore
    participant O as ğŸ”® Oracle
    participant VS as ğŸ“š VectorStore
    participant J as ğŸ“„ iching_complete.json
    participant G as ğŸ¤– Gemini API

    U-&gt;&gt;D: è¼¸å…¥è‚¡ç¥¨ä»£è™Ÿ/å•é¡Œ
    D-&gt;&gt;DL: fetch_data(ticker, market_type)
    DL-&gt;&gt;DL: æ ¼å¼åŒ– ticker&lt;br/&gt;(ä¾‹å¦‚ 2330 â†’ 2330.TW)
    DL--&gt;&gt;D: raw_df (OHLCV)
    
    D-&gt;&gt;ME: generate_hexagrams(raw_df)
    ME-&gt;&gt;ME: è¨ˆç®—æŠ€è¡“æŒ‡æ¨™&lt;br/&gt;(RVOL, RVOL_Percentile)
    ME-&gt;&gt;ME: å¤§è¡ä¹‹æ•¸æ˜ å°„&lt;br/&gt;(RVOL â†’ 6/7/8/9)
    ME-&gt;&gt;ME: æ»¾å‹•çª—å£(6å¤©)&lt;br/&gt;â†’ Ritual_Sequence
    ME-&gt;&gt;IC: è¨ˆç®—æœ¬å¦/ä¹‹å¦
    IC--&gt;&gt;ME: æœ¬å¦/ä¹‹å¦è³‡è¨Š
    ME--&gt;&gt;D: encoded_df&lt;br/&gt;(å« Ritual_Sequence)
    
    D-&gt;&gt;IC: interpret_sequence(ritual_sequence)
    IC--&gt;&gt;D: current_hex, future_hex, moving_lines
    
    D-&gt;&gt;D: çµ„æˆ current_market_state
    D-&gt;&gt;D: ç•« K ç·šåœ–ã€å¦è±¡è¦–è¦ºåŒ–
    
    D-&gt;&gt;O: ask(ticker, question,&lt;br/&gt;precomputed_data)
    O-&gt;&gt;O: _resolve_strategy&lt;br/&gt;(ä¾å‹•çˆ»æ•¸é‡æ±ºå®šç­–ç•¥)
    O-&gt;&gt;J: ä¾ hex_id + line_number&lt;br/&gt;æŠ½å–ç¶“æ–‡
    J--&gt;&gt;O: æœ¬å¦ï¼‹ä¹‹å¦ï¼‹å‹•çˆ»åŸæ–‡
    
    O-&gt;&gt;O: å»ºç«‹ç³»çµ±æç¤º&lt;br/&gt;(å«è²/æ‚”æ¡†æ¶)
    O-&gt;&gt;G: generate_content(system_prompt)
    G--&gt;&gt;O: çµæ§‹åŒ–å›ç­” (Markdown)
    
    O--&gt;&gt;D: åœå¦è§£è®€
    D--&gt;&gt;U: é¡¯ç¤ºçµæœ&lt;br/&gt;(Kç·šåœ– + å¦è±¡ + è§£è®€)</code></pre>
<hr>
</section>
</section>
<section id="ä¹‹å¦ç­–ç•¥æ±ºç­–æ¨¹" class="level2">
<h2 class="anchored" data-anchor-id="ä¹‹å¦ç­–ç•¥æ±ºç­–æ¨¹">ä¹‹å¦ç­–ç•¥æ±ºç­–æ¨¹</h2>
<pre class="mermaid"><code>flowchart TD
    Start([é–‹å§‹: ç²å– ritual_sequence]) --&gt; Count{è¨ˆç®—å‹•çˆ»æ•¸é‡&lt;br/&gt;(6 å’Œ 9 çš„æ•¸é‡)}
    
    Count --&gt;|0 å‹•çˆ»| Strategy0[Total Acceptance&lt;br/&gt;æŸ¥æœ¬å¦å¦è¾­/è±¡è¾­]
    Count --&gt;|1 å‹•çˆ»| Strategy1[Specific Focus&lt;br/&gt;æŸ¥è©²å‹•çˆ»æ–‡æœ¬]
    Count --&gt;|2 å‹•çˆ»| Strategy2[Primary vs Secondary&lt;br/&gt;ä¸‹çˆ»è²/ä¸Šçˆ»æ‚”]
    Count --&gt;|3 å‹•çˆ»| Strategy3[Hedging Moment&lt;br/&gt;æœ¬å¦è²/ä¹‹å¦æ‚”]
    Count --&gt;|4-5 å‹•çˆ»| Strategy45[Trend Reversal&lt;br/&gt;ä¹‹å¦è²/æœ¬å¦æ‚”]
    Count --&gt;|6 å‹•çˆ»| Check6{æ˜¯å¦ç‚ºä¹¾/å¤å¦?}
    
    Check6 --&gt;|ä¹¾å¦| Strategy6Qian[Extreme Reversal&lt;br/&gt;ç”¨ã€Œç”¨ä¹ã€]
    Check6 --&gt;|å¤å¦| Strategy6Kun[Extreme Reversal&lt;br/&gt;ç”¨ã€Œç”¨å…­ã€]
    Check6 --&gt;|å…¶ä»–| Strategy6Other[Extreme Reversal&lt;br/&gt;ç”¨ä¹‹å¦å¦è¾­]
    
    Strategy0 --&gt; Query[å¾ iching_complete.json&lt;br/&gt;æŠ½å–å°æ‡‰ç¶“æ–‡]
    Strategy1 --&gt; Query
    Strategy2 --&gt; Query
    Strategy3 --&gt; Query
    Strategy45 --&gt; Query
    Strategy6Qian --&gt; Query
    Strategy6Kun --&gt; Query
    Strategy6Other --&gt; Query
    
    Query --&gt; Prompt[æ§‹é€ ç³»çµ±æç¤º&lt;br/&gt;å«è²/æ‚”æ¡†æ¶]
    Prompt --&gt; Gemini[Gemini API ç”Ÿæˆå›ç­”]
    Gemini --&gt; Output[è¿”å›çµæ§‹åŒ–è§£è®€]
    
    style Strategy0 fill:#e8f5e9
    style Strategy1 fill:#fff3e0
    style Strategy2 fill:#e1f5fe
    style Strategy3 fill:#f3e5f5
    style Strategy45 fill:#fce4ec
    style Strategy6Qian fill:#ffebee
    style Strategy6Kun fill:#ffebee
    style Strategy6Other fill:#ffebee</code></pre>
<hr>
</section>
<section id="å¤§è¡ä¹‹æ•¸æ˜ å°„æµç¨‹" class="level2">
<h2 class="anchored" data-anchor-id="å¤§è¡ä¹‹æ•¸æ˜ å°„æµç¨‹">å¤§è¡ä¹‹æ•¸æ˜ å°„æµç¨‹</h2>
<pre class="mermaid"><code>flowchart LR
    Start([å¸‚å ´è³‡æ–™&lt;br/&gt;OHLCV]) --&gt; Calc[è¨ˆç®—æŠ€è¡“æŒ‡æ¨™]
    Calc --&gt; RVOL[RVOL = Volume / Volume_MA20]
    RVOL --&gt; Percentile[RVOL_Percentile&lt;br/&gt;æ»¾å‹•çª—å£ç™¾åˆ†ä½æ•¸]
    
    Percentile --&gt; Map{å¤§è¡ä¹‹æ•¸æ˜ å°„}
    
    Map --&gt;|0-6.25%| Y6[6 è€é™°&lt;br/&gt;æ¥µä½èƒ½é‡]
    Map --&gt;|6.25-50%| Y8[8 å°‘é™°&lt;br/&gt;ä½-ä¸­èƒ½é‡]
    Map --&gt;|50-81.25%| Y7[7 å°‘é™½&lt;br/&gt;ä¸­-é«˜èƒ½é‡]
    Map --&gt;|81.25-100%| Y9[9 è€é™½&lt;br/&gt;æ¥µé«˜èƒ½é‡]
    
    Y6 --&gt; Window[æ»¾å‹•çª—å£&lt;br/&gt;6å¤©]
    Y8 --&gt; Window
    Y7 --&gt; Window
    Y9 --&gt; Window
    
    Window --&gt; Sequence[Ritual_Sequence&lt;br/&gt;ä¾‹å¦‚: 987896]
    Sequence --&gt; Binary[Hexagram_Binary&lt;br/&gt;ä¾‹å¦‚: 101010]
    Binary --&gt; Hexagram[æŸ¥è©¢ HEXAGRAM_MAP&lt;br/&gt;å–å¾—æœ¬å¦]
    
    style Y6 fill:#ffebee
    style Y8 fill:#fff3e0
    style Y7 fill:#e8f5e9
    style Y9 fill:#e1f5fe</code></pre>
<hr>
</section>
<section id="è²æ‚”æ¶æ§‹èªªæ˜" class="level2">
<h2 class="anchored" data-anchor-id="è²æ‚”æ¶æ§‹èªªæ˜">è²/æ‚”æ¶æ§‹èªªæ˜</h2>
<pre class="mermaid"><code>flowchart TB
    subgraph Framework["è²/æ‚”æ¶æ§‹ (Zhen/Hui Framework)"]
        direction LR
        Zhen[è² (Zhen)&lt;br/&gt;â€¢ ä¸»é«”&lt;br/&gt;â€¢ æ”¯æ’&lt;br/&gt;â€¢ é•·æœŸ&lt;br/&gt;â€¢ é€²å ´&lt;br/&gt;â€¢ æŒæœ‰]
        Hui[æ‚” (Hui)&lt;br/&gt;â€¢ å®¢é«”&lt;br/&gt;â€¢ é˜»åŠ›&lt;br/&gt;â€¢ çŸ­æœŸ&lt;br/&gt;â€¢ å‡ºå ´&lt;br/&gt;â€¢ é¢¨éšª]
    end
    
    subgraph Mapping["é‡‘èæ˜ å°„"]
        direction LR
        ZhenMap[è² â†’ è¶¨å‹¢æ”¯æ’&lt;br/&gt;ä¸»è¦æ–¹å‘&lt;br/&gt;å¯å€šè³´çš„å±¤ç´š]
        HuiMap[æ‚” â†’ é¢¨éšªç®¡ç†&lt;br/&gt;å£“åŠ›ä½&lt;br/&gt;éœ€è­¦æƒ•çš„å±¤ç´š]
    end
    
    subgraph Example["æ“ä½œå»ºè­°ç¯„ä¾‹"]
        direction TB
        ZhenAdvice[è²ï¼šXX ä»¥ä¸‹è¦–ç‚ºæ”¯æ’&lt;br/&gt;å¯æŒæœ‰ã€é€¢å›åŠ ç¢¼]
        HuiAdvice[æ‚”ï¼šYY ä»¥ä¸Šæ³¨æ„é¢¨éšª&lt;br/&gt;è€ƒæ…®æ¸›ç¢¼ã€åš´æ ¼æ­¢æ]
    end
    
    Framework --&gt; Mapping
    Mapping --&gt; Example
    
    style Zhen fill:#e8f5e9
    style Hui fill:#ffebee
    style ZhenMap fill:#e8f5e9
    style HuiMap fill:#ffebee</code></pre>
<hr>
</section>
<section id="æ¨¡çµ„åŠŸèƒ½å°ç…§è¡¨" class="level2">
<h2 class="anchored" data-anchor-id="æ¨¡çµ„åŠŸèƒ½å°ç…§è¡¨">æ¨¡çµ„åŠŸèƒ½å°ç…§è¡¨</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 38%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>æ¨¡çµ„</th>
<th>æª”æ¡ˆ</th>
<th>ä¸»è¦é¡åˆ¥/å‡½æ•¸</th>
<th>æ ¸å¿ƒåŠŸèƒ½</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>è³‡æ–™ç²å–</strong></td>
<td><code>data_loader.py</code></td>
<td><code>MarketDataLoader</code></td>
<td>å¾ Yahoo Finance ç²å– OHLCV è³‡æ–™ï¼Œæ”¯æ´å¤šå¸‚å ´</td>
</tr>
<tr class="even">
<td><strong>å¦è±¡ç·¨ç¢¼</strong></td>
<td><code>market_encoder.py</code></td>
<td><code>MarketEncoder</code></td>
<td>åƒ¹æ ¼/æˆäº¤é‡ â†’ å››è±¡(6/7/8/9) â†’ å…­çˆ»å¦è±¡</td>
</tr>
<tr class="odd">
<td><strong>å¦è±¡è§£ç¢¼</strong></td>
<td><code>iching_core.py</code></td>
<td><code>IChingCore</code></td>
<td>æœ¬å¦/ä¹‹å¦/å‹•çˆ»è¨ˆç®—èˆ‡æŸ¥è©¢</td>
</tr>
<tr class="even">
<td><strong>è¨­å®šæª”</strong></td>
<td><code>config.py</code></td>
<td><code>Settings</code>, <code>HEXAGRAM_MAP</code></td>
<td>å…¨åŸŸè¨­å®šèˆ‡64å¦å°ç…§è¡¨</td>
</tr>
<tr class="odd">
<td><strong>çŸ¥è­˜è¼‰å…¥</strong></td>
<td><code>knowledge_loader.py</code></td>
<td><code>IChingKnowledgeLoader</code></td>
<td>JSON â†’ æ–‡ä»¶ç‰©ä»¶ï¼ˆä¸»å¦+å…­çˆ»ï¼‰</td>
</tr>
<tr class="even">
<td><strong>å‘é‡è³‡æ–™åº«</strong></td>
<td><code>vector_store.py</code></td>
<td><code>IChingVectorStore</code></td>
<td>ChromaDB èªç¾©æœå°‹èˆ‡åš´æ ¼éæ¿¾</td>
</tr>
<tr class="odd">
<td><strong>ç¥è«­æ ¸å¿ƒ</strong></td>
<td><code>oracle_chat.py</code></td>
<td><code>Oracle</code></td>
<td>æ•´åˆæ‰€æœ‰æ¨¡çµ„ï¼Œä¹‹å¦ç­–ç•¥ï¼ŒGemini API</td>
</tr>
<tr class="even">
<td><strong>Web ä»‹é¢</strong></td>
<td><code>dashboard.py</code></td>
<td>-</td>
<td>Streamlit å„€è¡¨æ¿ï¼ŒKç·šåœ–ï¼Œå¦è±¡è¦–è¦ºåŒ–</td>
</tr>
<tr class="odd">
<td><strong>CLI å·¥å…·</strong></td>
<td><code>main.py</code></td>
<td><code>main()</code></td>
<td>å‘½ä»¤åˆ—ä»‹é¢ï¼ŒASCII è—è¡“å¦è±¡</td>
</tr>
<tr class="even">
<td><strong>è³‡æ–™è™•ç†</strong></td>
<td><code>data_processor.py</code></td>
<td><code>DataProcessor</code></td>
<td>æº–å‚™ LSTM è¨“ç·´è³‡æ–™ï¼ˆé›™æµæ¶æ§‹ï¼‰</td>
</tr>
<tr class="odd">
<td><strong>LSTM æ¨¡å‹</strong></td>
<td><code>model_lstm.py</code></td>
<td><code>QuantumLSTM</code></td>
<td>é›™æµ Embedding LSTM æ¨¡å‹</td>
</tr>
<tr class="even">
<td><strong>å›æ¸¬å¼•æ“</strong></td>
<td><code>backtester.py</code></td>
<td><code>QuantumBacktester</code></td>
<td>ç­–ç•¥å›æ¸¬èˆ‡ç¸¾æ•ˆè©•ä¼°</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="æŠ€è¡“æ£§ç¸½è¦½" class="level2">
<h2 class="anchored" data-anchor-id="æŠ€è¡“æ£§ç¸½è¦½">æŠ€è¡“æ£§ç¸½è¦½</h2>
<pre><code>è³‡æ–™ç²å–å±¤:
  â”œâ”€ yfinance (Yahoo Finance API)
  â”œâ”€ pandas (è³‡æ–™è™•ç†)
  â””â”€ numpy (æ•¸å€¼è¨ˆç®—)

å¦è±¡ç·¨ç¢¼å±¤:
  â”œâ”€ å¤§è¡ä¹‹æ•¸æ©Ÿç‡åˆ†å¸ƒ (å‚³çµ±æ˜“ç¶“é‚è¼¯)
  â”œâ”€ æ»¾å‹•çª—å£ (6å¤©)
  â””â”€ äºŒé€²åˆ¶ç·¨ç¢¼ (64å¦å°ç…§)

çŸ¥è­˜æª¢ç´¢å±¤:
  â”œâ”€ ChromaDB (å‘é‡è³‡æ–™åº«)
  â”œâ”€ SentenceTransformers (all-MiniLM-L6-v2)
  â””â”€ JSON (iching_complete.json)

æ‡‰ç”¨å±¤:
  â”œâ”€ Streamlit (Web ä»‹é¢)
  â”œâ”€ Plotly (Kç·šåœ–è¦–è¦ºåŒ–)
  â””â”€ Google Gemini API (LLMç”Ÿæˆ)

æ©Ÿå™¨å­¸ç¿’å±¤ (å¯é¸):
  â”œâ”€ PyTorch (LSTM æ¨¡å‹)
  â”œâ”€ XGBoost (æ³¢å‹•æ€§é æ¸¬)
  â””â”€ sklearn (è³‡æ–™æ¨™æº–åŒ–)</code></pre>
<hr>
</section>
<section id="é—œéµè¨­è¨ˆåŸå‰‡" class="level2">
<h2 class="anchored" data-anchor-id="é—œéµè¨­è¨ˆåŸå‰‡">é—œéµè¨­è¨ˆåŸå‰‡</h2>
<ol type="1">
<li><strong>Calculate Once, Use Everywhere</strong>
<ul>
<li>Dashboard è¨ˆç®—å¦è±¡ä¸€æ¬¡ï¼Œå‚³çµ¦ Oracle ä½¿ç”¨</li>
<li>ç¢ºä¿å‰å¾Œç«¯å¦è±¡å®Œå…¨ä¸€è‡´</li>
</ul></li>
<li><strong>åš´æ ¼å°æ‡‰æ˜“ç¶“åŸæ–‡</strong>
<ul>
<li>ç›´æ¥å¾ JSON ä¾ hex_id + line_number æŠ½å–</li>
<li>ä¸ä¾è³´èªç¾©æœå°‹æ±ºå®šå¦è±¡</li>
<li>ç¢ºä¿ 100% æº–ç¢ºæ€§</li>
</ul></li>
<li><strong>ç³»çµ±åŒ–ä¹‹å¦ç­–ç•¥</strong>
<ul>
<li>ä¾å‹•çˆ»æ•¸é‡å‹•æ…‹é¸æ“‡æŸ¥è©¢ç­–ç•¥</li>
<li>çµåˆè²/æ‚”æ¶æ§‹æä¾›çµæ§‹åŒ–åˆ†æ</li>
</ul></li>
<li><strong>å¤§è¡ä¹‹æ•¸æ©Ÿç‡åˆ†å¸ƒ</strong>
<ul>
<li>ä½¿ç”¨å‚³çµ±æ˜“ç¶“æ©Ÿç‡åˆ†å¸ƒ</li>
<li>ç¬¦åˆæ˜“ç¶“å‚³çµ±é‚è¼¯</li>
</ul></li>
<li><strong>å¤šå¸‚å ´çµ±ä¸€ä»‹é¢</strong>
<ul>
<li>è‡ªå‹•æ ¼å¼åŒ– ticker</li>
<li>ä½¿ç”¨è€…ç„¡éœ€æ‰‹å‹•è¼¸å…¥å¾Œç¶´</li>
</ul></li>
</ol>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>